{% extends "libstat/base.html" %}
{% load libstat_tags %}
{% load i18n %}

{% block content %}
    <style>
        .observation-group {
            margin-bottom: 50px;
        }

        .report {
            width: 800px;
            margin: 0px auto;
            padding-top: 30px;
            padding-bottom: 70px;
        }

        th {
            padding-top: 5px;
            padding-bottom: 5px;
        }

        th, td {
            padding-left: 15px;
            padding-right: 15px;
        }

        td {
            padding-top: 5px;
            padding-bottom: 5px;
        }

        .even td:not(.observation-data-missing) {
            background-color: #f2f2f2;
        }

        th.observation-label {
            background-color: rgb(255, 163, 56);
            color: white;
        }

        th.observation-previous-year {
            color: white;
            background-color: rgb(239, 131, 24);
            width: 85px;
        }

        th.observation-sample-year {
            color: white;
            background-color: rgb(220, 110, 16);
            width: 85px;
        }

        th.observation-difference {
            color: white;
            text-align: center;
            background-color: rgb(42, 176, 204);
            width: 110px;
        }

        th.observation-difference-total {
            background-color: rgb(37, 146, 188);
            color: white;
            text-align: center;
            width: 90px;
        }

        .observation-label {
            width: 500px;
        }

        .report-title {
            border-bottom: 5px solid black;
            font-size: 40px;
            font-family: helvetica;
            width: auto;
            text-align: center;

        }

        .libraries-label {
            font-size: 17px;
            font-family: helvetica;
            margin-top: 30px;
            margin-bottom: 5px;
        }

        .libraries {
            border-left: 8px solid black;
            padding-left: 15px;
            margin-bottom: 30px;
        }

        .libraries .library {
            padding-bottom: 7px;
            padding-top: 7px;
            font-size: 20px;
            font-family: helvetica;
        }

    </style>
    <div class="report">
        <div class="report-title">Verksamhetsrapport för året {{ year }}</div>

        <div>
            <div class="libraries-label">Serviceställen:</div>
            <div class="libraries">
                {% for library in libraries %}
                    <div class="library">{{ library.name }} ({{ library.city }}, {{ library.address }})</div>
                {% endfor %}
            </div>
        </div>
        {% for group in measurements %}
            <div class="observation-group">
                <table class="observation">
                    <tr>
                        <th class="observation-label">{{ group.title }}</th>
                        <th class="observation-previous-year">År {{ group.years.0 }}</th>
                        <th class="observation-sample-year">År {{ group.years.1 }}</th>
                        <th class="observation-difference">Förändring {{ group.years.0 }} - {{ group.years.1 }}</th>
                        <th class="observation-difference-total">Andel av riket</th>
                    </tr>
                    {% for row in group|access:"rows" %}
                        <tr class="{% if forloop.counter|divisibleby:2 %}even{% else %}odd{% endif %}">
                            <td class="observation-label">{{ row|access:"label" }}</td>
                            <td class="observation-previous-year">{{ row|access:group.years.0|floatformat:"0"|default:"-" }}</td>
                            <td class="observation-sample-year">{{ row|access:group.years.1|floatformat:"0"|default:"-" }}</td>
                            <td class="observation-difference">
                                {% if row.diff %}
                                    {{ row.diff|floatformat:"0"|default:"-" }}%
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td class="observation-difference-total">
                                {% if row.nation_diff %}
                                    {{ row.nation_diff|floatformat:"0"|default:"-" }}&permil;
                                {% else %}
                                    -
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
        {% endfor %}

        <div id="chart-unique" class="chart" style="width: 100%; height: 500px; font-size: 11px;"
             data-years="[2013,2014,2015]"
             data-chart='[{"label":"Antal anställda bibliotekarier","2013":3062000,"2014":3077000,"2015":3080009},{"label":"Antal övriga anställda","2013":2488000,"2014":2478000,"2015":2391000},{"label":"Antal årsverken bibliotekarier","2013":2706000,"2014":2727000,"2015":2756000},{"label":"Antal årsverken övriga anställda","2013":1959000,"2014":1931000,"2015":1872000},{"label":"varav antal årsverken som är avsatta för barn och unga","2013":962000,"2014":937000,"2015":975000}]'></div>
    </div>
{% endblock %}